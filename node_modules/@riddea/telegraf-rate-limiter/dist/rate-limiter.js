"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.RateLimiter = void 0;
const limiter_1 = require("limiter");
class RateLimiter {
    amount;
    interval;
    limiters = {};
    constructor(amount, interval) {
        this.amount = amount;
        this.interval = interval;
    }
    /**
     * Takes a token from the rate limiter.
     * @param key A key which identifies the entity being limited (Ex: user ID, chat ID, etc.).
     * @returns Whether this action exceeds the rate limit.
     */
    take(key) {
        let limiter = this.limiters[key];
        if (!limiter) {
            limiter = new limiter_1.RateLimiter(this.amount, this.interval);
            this.limiters[key] = limiter;
        }
        if (limiter.getTokensRemaining() < 1) {
            return true;
        }
        limiter.removeTokens(1, (error) => {
            if (error) {
                throw error;
            }
        });
        return false;
    }
}
exports.RateLimiter = RateLimiter;
//# sourceMappingURL=rate-limiter.js.map